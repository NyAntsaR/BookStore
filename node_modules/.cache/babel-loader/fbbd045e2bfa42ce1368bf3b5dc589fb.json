{"ast":null,"code":"import _objectSpread from \"/Users/nyantsa/Desktop/BookStore/bookfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/nyantsa/Desktop/BookStore/bookfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/nyantsa/Desktop/BookStore/bookfrontend/src/components/Admin/UpdateProduct.js\";\nimport React, { useState, useEffect } from \"react\";\nimport Layout from \"../Core/Layout\";\nimport { isAuthenticated } from \"../Auth\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { getProduct, getCategories, updateProduct } from \"./apiAdmin\";\n\nconst UpdateProduct = ({\n  match\n}) => {\n  const _useState = useState({\n    name: \"\",\n    description: \"\",\n    price: \"\",\n    categories: [],\n    category: \"\",\n    shipping: \"\",\n    quantity: \"\",\n    photo: \"\",\n    loading: false,\n    error: false,\n    createdProduct: \"\",\n    redirectToProfile: false,\n    formData: \"\"\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        values = _useState2[0],\n        setValues = _useState2[1];\n\n  const _isAuthenticated = isAuthenticated(),\n        user = _isAuthenticated.user,\n        token = _isAuthenticated.token;\n\n  const name = values.name,\n        description = values.description,\n        price = values.price,\n        categories = values.categories,\n        category = values.category,\n        shipping = values.shipping,\n        quantity = values.quantity,\n        loading = values.loading,\n        error = values.error,\n        createdProduct = values.createdProduct,\n        redirectToProfile = values.redirectToProfile,\n        formData = values.formData;\n\n  const init = productId => {\n    getProduct(productId).then(data => {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        // populate the state\n        setValues(_objectSpread({}, values, {\n          name: data.name,\n          description: data.description,\n          price: data.price,\n          category: data.category._id,\n          shipping: data.shipping,\n          quantity: data.quantity,\n          formData: new FormData()\n        })); // load categories\n\n        initCategories();\n      }\n    });\n  }; // load categories and set form data\n\n\n  const initCategories = () => {\n    getCategories().then(data => {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setValues({\n          categories: data,\n          formData: new FormData()\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    init(match.params.productId);\n  }, []);\n\n  const handleChange = name => event => {\n    const value = name === \"photo\" ? event.target.files[0] : event.target.value;\n    formData.set(name, value);\n    setValues(_objectSpread({}, values, {\n      [name]: value\n    }));\n  };\n\n  const clickSubmit = event => {\n    event.preventDefault();\n    setValues(_objectSpread({}, values, {\n      error: \"\",\n      loading: true\n    }));\n    updateProduct(match.params.productId, user._id, token, formData).then(data => {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setValues(_objectSpread({}, values, {\n          name: \"\",\n          description: \"\",\n          photo: \"\",\n          price: \"\",\n          quantity: \"\",\n          loading: false,\n          error: false,\n          redirectToProfile: true,\n          createdProduct: data.name\n        }));\n      }\n    });\n  };\n\n  const newPostForm = () => React.createElement(\"form\", {\n    className: \"mb-3\",\n    onSubmit: clickSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, \"Post Photo\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"btn btn-secondary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    onChange: handleChange(\"photo\"),\n    type: \"file\",\n    name: \"photo\",\n    accept: \"image/*\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, \"Name\"), React.createElement(\"input\", {\n    onChange: handleChange(\"name\"),\n    type: \"text\",\n    className: \"form-control\",\n    value: name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, \"Description\"), React.createElement(\"textarea\", {\n    onChange: handleChange(\"description\"),\n    className: \"form-control\",\n    value: description,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, \"Price\"), React.createElement(\"input\", {\n    onChange: handleChange(\"price\"),\n    type: \"number\",\n    className: \"form-control\",\n    value: price,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, \"Category\"), React.createElement(\"select\", {\n    onChange: handleChange(\"category\"),\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, \"Please select\"), categories && categories.map((c, i) => React.createElement(\"option\", {\n    key: i,\n    value: c._id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, c.name)))), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, \"Shipping\"), React.createElement(\"select\", {\n    onChange: handleChange(\"shipping\"),\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, \"Please select\"), React.createElement(\"option\", {\n    value: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, \"No\"), React.createElement(\"option\", {\n    value: \"1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, \"Yes\"))), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, \"Quantity\"), React.createElement(\"input\", {\n    onChange: handleChange(\"quantity\"),\n    type: \"number\",\n    className: \"form-control\",\n    value: quantity,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  })), React.createElement(\"button\", {\n    className: \"btn btn-outline-primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }, \"Update Product\"));\n\n  const showError = () => React.createElement(\"div\", {\n    className: \"alert alert-danger\",\n    style: {\n      display: error ? \"\" : \"none\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, error);\n\n  const showSuccess = () => React.createElement(\"div\", {\n    className: \"alert alert-info\",\n    style: {\n      display: createdProduct ? \"\" : \"none\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, \"\".concat(createdProduct), \" is updated!\"));\n\n  const showLoading = () => loading && React.createElement(\"div\", {\n    className: \"alert alert-success\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, \"Loading...\"));\n\n  const redirectUser = () => {\n    if (redirectToProfile) {\n      if (!error) {\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226\n          },\n          __self: this\n        });\n      }\n    }\n  };\n\n  return React.createElement(Layout, {\n    title: \"Add a new product\",\n    description: \"G'day \".concat(user.name, \", ready to add a new product?\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-md-8 offset-md-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }, showLoading(), showSuccess(), showError(), newPostForm(), redirectUser())));\n};\n\nexport default UpdateProduct;","map":{"version":3,"sources":["/Users/nyantsa/Desktop/BookStore/bookfrontend/src/components/Admin/UpdateProduct.js"],"names":["React","useState","useEffect","Layout","isAuthenticated","Link","Redirect","getProduct","getCategories","updateProduct","UpdateProduct","match","name","description","price","categories","category","shipping","quantity","photo","loading","error","createdProduct","redirectToProfile","formData","values","setValues","user","token","init","productId","then","data","_id","FormData","initCategories","params","handleChange","event","value","target","files","set","clickSubmit","preventDefault","newPostForm","map","c","i","showError","display","showSuccess","showLoading","redirectUser"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Layout from \"../Core/Layout\";\nimport { isAuthenticated } from \"../Auth\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { getProduct, getCategories, updateProduct } from \"./apiAdmin\";\n\nconst UpdateProduct = ({ match }) => {\n    const [values, setValues] = useState({\n        name: \"\",\n        description: \"\",\n        price: \"\",\n        categories: [],\n        category: \"\",\n        shipping: \"\",\n        quantity: \"\",\n        photo: \"\",\n        loading: false,\n        error: false,\n        createdProduct: \"\",\n        redirectToProfile: false,\n        formData: \"\"\n    });\n\n    const { user, token } = isAuthenticated();\n    const {\n        name,\n        description,\n        price,\n        categories,\n        category,\n        shipping,\n        quantity,\n        loading,\n        error,\n        createdProduct,\n        redirectToProfile,\n        formData\n    } = values;\n\n    const init = productId => {\n        getProduct(productId).then(data => {\n            if (data.error) {\n                setValues({ ...values, error: data.error });\n            } else {\n                // populate the state\n                setValues({\n                    ...values,\n                    name: data.name,\n                    description: data.description,\n                    price: data.price,\n                    category: data.category._id,\n                    shipping: data.shipping,\n                    quantity: data.quantity,\n                    formData: new FormData()\n                });\n                // load categories\n                initCategories();\n            }\n        });\n    };\n\n    // load categories and set form data\n    const initCategories = () => {\n        getCategories().then(data => {\n            if (data.error) {\n                setValues({ ...values, error: data.error });\n            } else {\n                setValues({\n                    categories: data,\n                    formData: new FormData()\n                });\n            }\n        });\n    };\n\n    useEffect(() => {\n        init(match.params.productId);\n    }, []);\n\n    const handleChange = name => event => {\n        const value =\n            name === \"photo\" ? event.target.files[0] : event.target.value;\n        formData.set(name, value);\n        setValues({ ...values, [name]: value });\n    };\n\n    const clickSubmit = event => {\n        event.preventDefault();\n        setValues({ ...values, error: \"\", loading: true });\n\n        updateProduct(match.params.productId, user._id, token, formData).then(\n            data => {\n                if (data.error) {\n                    setValues({ ...values, error: data.error });\n                } else {\n                    setValues({\n                        ...values,\n                        name: \"\",\n                        description: \"\",\n                        photo: \"\",\n                        price: \"\",\n                        quantity: \"\",\n                        loading: false,\n                        error: false,\n                        redirectToProfile: true,\n                        createdProduct: data.name\n                    });\n                }\n            }\n        );\n    };\n\n    const newPostForm = () => (\n        <form className=\"mb-3\" onSubmit={clickSubmit}>\n            <h4>Post Photo</h4>\n            <div className=\"form-group\">\n                <label className=\"btn btn-secondary\">\n                    <input\n                        onChange={handleChange(\"photo\")}\n                        type=\"file\"\n                        name=\"photo\"\n                        accept=\"image/*\"\n                    />\n                </label>\n            </div>\n\n            <div className=\"form-group\">\n                <label className=\"text-muted\">Name</label>\n                <input\n                    onChange={handleChange(\"name\")}\n                    type=\"text\"\n                    className=\"form-control\"\n                    value={name}\n                />\n            </div>\n\n            <div className=\"form-group\">\n                <label className=\"text-muted\">Description</label>\n                <textarea\n                    onChange={handleChange(\"description\")}\n                    className=\"form-control\"\n                    value={description}\n                />\n            </div>\n\n            <div className=\"form-group\">\n                <label className=\"text-muted\">Price</label>\n                <input\n                    onChange={handleChange(\"price\")}\n                    type=\"number\"\n                    className=\"form-control\"\n                    value={price}\n                />\n            </div>\n\n            <div className=\"form-group\">\n                <label className=\"text-muted\">Category</label>\n                <select\n                    onChange={handleChange(\"category\")}\n                    className=\"form-control\"\n                >\n                    <option>Please select</option>\n                    {categories &&\n                        categories.map((c, i) => (\n                            <option key={i} value={c._id}>\n                                {c.name}\n                            </option>\n                        ))}\n                </select>\n            </div>\n\n            <div className=\"form-group\">\n                <label className=\"text-muted\">Shipping</label>\n                <select\n                    onChange={handleChange(\"shipping\")}\n                    className=\"form-control\"\n                >\n                    <option>Please select</option>\n                    <option value=\"0\">No</option>\n                    <option value=\"1\">Yes</option>\n                </select>\n            </div>\n\n            <div className=\"form-group\">\n                <label className=\"text-muted\">Quantity</label>\n                <input\n                    onChange={handleChange(\"quantity\")}\n                    type=\"number\"\n                    className=\"form-control\"\n                    value={quantity}\n                />\n            </div>\n\n            <button className=\"btn btn-outline-primary\">Update Product</button>\n        </form>\n    );\n\n    const showError = () => (\n        <div\n            className=\"alert alert-danger\"\n            style={{ display: error ? \"\" : \"none\" }}\n        >\n            {error}\n        </div>\n    );\n\n    const showSuccess = () => (\n        <div\n            className=\"alert alert-info\"\n            style={{ display: createdProduct ? \"\" : \"none\" }}\n        >\n            <h2>{`${createdProduct}`} is updated!</h2>\n        </div>\n    );\n\n    const showLoading = () =>\n        loading && (\n            <div className=\"alert alert-success\">\n                <h2>Loading...</h2>\n            </div>\n        );\n\n    const redirectUser = () => {\n        if (redirectToProfile) {\n            if (!error) {\n                return <Redirect to=\"/\" />;\n            }\n        }\n    };\n\n    return (\n        <Layout\n            title=\"Add a new product\"\n            description={`G'day ${user.name}, ready to add a new product?`}\n        >\n            <div className=\"row\">\n                <div className=\"col-md-8 offset-md-2\">\n                    {showLoading()}\n                    {showSuccess()}\n                    {showError()}\n                    {newPostForm()}\n                    {redirectUser()}\n                </div>\n            </div>\n        </Layout>\n    );\n};\n\nexport default UpdateProduct;\n"]},"metadata":{},"sourceType":"module"}